{"version":3,"file":"index.js","sources":["../../src/utils.ts","../../src/action.ts","../../src/action-func.ts","../../src/action-sleep.ts","../../src/run-all.ts","../../src/run-one.ts","../../src/run-queue.ts","../../src/run-step.ts"],"sourcesContent":["import type { Action } from './action';\n\nexport interface ActionContext {\n\tlogger?: (level: string, msg: any, action?: Action) => void;\n\tdatas?: { [name: string]: any };\n\terrs?: Error[];\n\t[name: string]: any;\n}\n\nexport const isError = (e: any) => Object.prototype.toString.call(e) === '[object Error]' || e instanceof Error;\n\nexport type ActionWatcher = (action?: Action, context?: any, data?: any, err?: Error) => any;\n\nexport interface Deferer {\n\tp?: Promise<any>;\n\tresolve?: any;\n\treject?: any;\n}\nexport const defer = (): Deferer => {\n\tconst d: Deferer = {} as any;\n\td.p = new Promise((resolve, reject) => {\n\t\td.resolve = resolve;\n\t\td.reject = reject;\n\t});\n\treturn d;\n};\n\nexport const ActionStatus = {\n\tIdle: 0,\n\tPending: 1,\n\tResolved: 2,\n\tRejected: 3,\n\tStopped: 4,\n};\n\nexport const ErrHandler = {\n\tIgnore: 0,\n\tRejectImmediately: 1,\n\tRejectAllDone: 2,\n};\n","import { ActionStatus, type ActionWatcher, type Deferer, ErrHandler, defer, isError } from './utils';\n\nexport class Action {\n\tprotected parent: Action;\n\tprotected context: any;\n\tprotected name: string;\n\tprotected status: number = ActionStatus.Idle;\n\tprotected data: any;\n\tprotected error: Error;\n\tprotected watchers: ActionWatcher[];\n\t//utils\n\tprotected rp: Deferer;\n\n\tpublic setContext(context: any) {\n\t\tthis.context = context;\n\t\treturn this;\n\t}\n\tpublic getContext() {\n\t\treturn this.context;\n\t}\n\tpublic setName(name: string) {\n\t\tthis.name = name;\n\t\treturn this;\n\t}\n\tpublic getName(): string {\n\t\treturn this.name;\n\t}\n\tpublic getFullName(ln = '/', showAll = false): string {\n\t\tlet name = this.name || (showAll ? '..' : '');\n\t\tif (this.parent) {\n\t\t\tlet pn = this.parent.getFullName(ln, showAll);\n\t\t\tif (pn) {\n\t\t\t\treturn !name ? pn : `${pn}${ln}${name}`;\n\t\t\t}\n\t\t}\n\t\treturn name;\n\t}\n\tpublic getData() {\n\t\treturn this.data;\n\t}\n\tpublic getError() {\n\t\treturn this.error;\n\t}\n\t//状态\n\tpublic getStatus() {\n\t\treturn this.status;\n\t}\n\tpublic isIdle() {\n\t\treturn this.status === ActionStatus.Idle;\n\t}\n\tpublic isPending() {\n\t\treturn this.status === ActionStatus.Pending;\n\t}\n\tpublic isResolved() {\n\t\treturn this.status === ActionStatus.Resolved;\n\t}\n\tpublic isRejected() {\n\t\treturn this.status === ActionStatus.Rejected;\n\t}\n\tpublic isStopped() {\n\t\treturn this.status === ActionStatus.Stopped;\n\t}\n\t//watcher\n\tpublic watch(w: ActionWatcher, index = -1) {\n\t\tlet ws = this.watchers || (this.watchers = []);\n\t\tif (index < 0) ws.push(w);\n\t\telse if (!ws[index]) ws[index] = w;\n\t\telse {\n\t\t\tws.splice(index, 0, w);\n\t\t}\n\t\treturn this;\n\t}\n\t//\n\tprotected getRP() {\n\t\treturn this.rp || (this.rp = defer());\n\t}\n\tprotected endRP(resolve = true, data?: any) {\n\t\tif (this.rp) {\n\t\t\tresolve ? this.rp.resolve(data) : this.rp.reject(data || new Error('end runtime promise'));\n\t\t}\n\t}\n\tprotected logData() {\n\t\tif (this.data && this.context && this.name) {\n\t\t\t(this.context.datas || (this.context.datas = {}))[this.name] = this.data;\n\t\t}\n\t}\n\tprotected logErr() {\n\t\tif (this.context && (!this.context.errs || this.context.errs.indexOf(this.error) < 0)) {\n\t\t\t(this.context.errs || (this.context.errs = [])).push(this.error);\n\t\t\tif (this.context.logger) this.context.logger('error', this.error, this);\n\t\t}\n\t}\n\tprotected dispatch() {\n\t\tif (!this.watchers) return;\n\t\t//\n\t\tfor (let w of this.watchers) {\n\t\t\tif (w) w(this, this.context, this.data, this.error);\n\t\t}\n\t\tthis.watchers.length = 0;\n\t}\n\n\t//执行\n\tpublic async start(context?: any) {\n\t\tif (this.isIdle()) {\n\t\t\tlet data: any;\n\t\t\ttry {\n\t\t\t\tthis.context = this.context || context;\n\t\t\t\tthis.status = ActionStatus.Pending;\n\t\t\t\tdata = await this.doStart(this.context);\n\t\t\t\t//如果返回了另外一个Action\n\t\t\t\tif (data instanceof Action) {\n\t\t\t\t\tlet a = data as Action;\n\t\t\t\t\tdata = a.isResolved() ? a.getData() : a.getError() || new Error('unknown');\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tdata = err;\n\t\t\t}\n\t\t\t//console.log('then', this.name, this.isPending(), data);\n\t\t\tif (this.isPending()) {\n\t\t\t\tif (!isError(data)) {\n\t\t\t\t\tthis.data = data;\n\t\t\t\t\tthis.status = ActionStatus.Resolved;\n\t\t\t\t\tthis.logData();\n\t\t\t\t} else {\n\t\t\t\t\tthis.error = data;\n\t\t\t\t\tthis.status = ActionStatus.Rejected;\n\t\t\t\t\tthis.logErr();\n\t\t\t\t}\n\t\t\t\tawait this.doStop(this.context);\n\t\t\t\tif (this.rp) this.endRP(true);\n\t\t\t\tthis.dispatch();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\tprotected async doStart(context: any) {\n\t\treturn null as any;\n\t}\n\tpublic async stop(context?: any) {\n\t\tif (this.isIdle() || this.isPending()) {\n\t\t\tlet isPending = this.isPending();\n\t\t\tthis.status = ActionStatus.Stopped;\n\t\t\tif (isPending) {\n\t\t\t\tthis.context = this.context || context;\n\t\t\t\tawait this.doStop(this.context);\n\t\t\t\tif (this.rp) this.endRP(true);\n\t\t\t}\n\t\t\tthis.dispatch();\n\t\t}\n\t\treturn this;\n\t}\n\tprotected async doStop(context: any) {\n\t\treturn null as any;\n\t}\n}\n\nexport class CompositeAction extends Action {\n\tprotected children: Action[] = [];\n\tprotected errHandler: number = ErrHandler.Ignore;\n\n\tconstructor(errHandler: number = ErrHandler.Ignore) {\n\t\tsuper();\n\t\tthis.errHandler = errHandler;\n\t}\n\tpublic setErrHandler(errHandler: number) {\n\t\tthis.errHandler = errHandler;\n\t\treturn this;\n\t}\n\t//层级结构\n\tpublic addChild(a: Action) {\n\t\tthis.children.push(a);\n\t\t(a as any).parent = this;\n\t\treturn this;\n\t}\n\tpublic addChildren(as: Action[]) {\n\t\tfor (let a of as) {\n\t\t\tthis.children.push(a);\n\t\t\t(a as any).parent = this;\n\t\t}\n\t\treturn this;\n\t}\n\tpublic numChildren() {\n\t\treturn this.children.length;\n\t}\n\n\tprotected async doStop(context: any) {\n\t\tif (this.children.length > 0) {\n\t\t\tlet all = [];\n\t\t\tfor (const a of this.children) all.push(a.stop(context));\n\t\t\tawait Promise.all(all);\n\t\t}\n\t\tthis.children.length = 0;\n\t}\n}\n","import { Action } from './action';\n\nexport type Func = (context: any, caller?: ActionForFunc) => Promise<any>;\n\nexport class ActionForFunc extends Action {\n\tprivate innerDoStart: Func;\n\tprivate innerDoStop?: Func;\n\n\tconstructor(doStart?: Func, doStop?: Func) {\n\t\tsuper();\n\t\tthis.innerDoStart = doStart;\n\t\tthis.innerDoStop = doStop;\n\t}\n\tpublic setDoStart(f: Func) {\n\t\tthis.innerDoStart = f;\n\t\treturn this;\n\t}\n\tpublic setDoStop(f: Func) {\n\t\tthis.innerDoStop = f;\n\t\treturn this;\n\t}\n\n\tprotected async doStart(context: any) {\n\t\treturn this.innerDoStart(context, this);\n\t}\n\n\tprotected async doStop(context: any) {\n\t\tif (this.innerDoStop) return this.innerDoStop(context, this);\n\t}\n}\n","import { Action } from './action';\n\nexport class ActionForSleep extends Action {\n\tprivate timeout: number;\n\tprivate timer: any;\n\n\tconstructor(timeout: number) {\n\t\tsuper();\n\t\tthis.timeout = timeout;\n\t}\n\n\tprotected async doStart() {\n\t\tlet rp = this.getRP();\n\t\tthis.timer = setTimeout(rp.resolve, this.timeout);\n\t\tawait rp.p;\n\t}\n\n\tprotected async doStop() {\n\t\tif (this.timer) clearTimeout(this.timer);\n\t\tthis.timer = undefined;\n\t}\n}\n","import { type Action, CompositeAction } from './action';\nimport { ErrHandler } from './utils';\n\nexport class RunAll extends CompositeAction {\n\tprotected async doStart(context: any) {\n\t\tif (this.children.length <= 0) return;\n\t\t//\n\t\tlet total = this.children.length;\n\t\tlet count = 0;\n\t\tlet w: any;\n\t\tlet e: Error;\n\t\tfor (const action of this.children) {\n\t\t\taction.start(context).then(\n\t\t\t\tw ||\n\t\t\t\t\t(w = (action: Action) => {\n\t\t\t\t\t\tif (!this.isPending()) return this.getRP().reject();\n\t\t\t\t\t\t//\n\t\t\t\t\t\tcount++;\n\t\t\t\t\t\tif (action.isRejected()) {\n\t\t\t\t\t\t\tif (!e) e = action.getError();\n\t\t\t\t\t\t\tif (this.errHandler === ErrHandler.RejectImmediately) return this.getRP().reject(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (count >= total) {\n\t\t\t\t\t\t\tif (e && this.errHandler === ErrHandler.RejectAllDone) this.getRP().reject(e);\n\t\t\t\t\t\t\telse this.getRP().resolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\t//\n\t\tawait this.getRP().p;\n\t}\n}\n","import { CompositeAction } from './action';\nimport { ErrHandler } from './utils';\n\nexport class RunOne extends CompositeAction {\n\tprotected async doStart(context: any) {\n\t\tlet e: Error;\n\t\twhile (this.children.length > 0) {\n\t\t\tlet action = this.children.shift();\n\t\t\tawait action.start(context);\n\t\t\tif (this.isPending() && action.isRejected()) {\n\t\t\t\tif (this.errHandler === ErrHandler.RejectImmediately) throw action.getError();\n\t\t\t\tif (!e) {\n\t\t\t\t\te = action.getError();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//\n\t\tif (e && this.errHandler === ErrHandler.RejectAllDone) throw e;\n\t}\n}\n","import { type Action, CompositeAction } from './action';\nimport { ErrHandler } from './utils';\n\nexport class RunQueue extends CompositeAction {\n\tpublic static StopHandlerManual = 0;\n\tpublic static StopHandlerAuto = 1;\n\tpublic static StopHandlerAutoAtLeastOnce = 2;\n\n\tprotected stopHandler = RunQueue.StopHandlerAuto;\n\tprotected runCount = 5;\n\tprotected running: Action[] = [];\n\tprotected w: any;\n\tprotected e: Error;\n\tprotected toStop = false;\n\n\tconstructor(\n\t\trunCount = 5,\n\t\tstopHandler: number = RunQueue.StopHandlerAuto,\n\t\terrHandler: number = ErrHandler.RejectAllDone\n\t) {\n\t\tsuper(errHandler);\n\t\tthis.runCount = runCount;\n\t\tthis.stopHandler = stopHandler;\n\t}\n\tpublic setRunCount(runCount: number) {\n\t\tthis.runCount = runCount;\n\t\treturn this;\n\t}\n\tpublic setStopHandler(stopHandler: number) {\n\t\tthis.stopHandler = stopHandler;\n\t\treturn this;\n\t}\n\tpublic setToStop() {\n\t\tthis.toStop = true;\n\t\t//查看是否可以立即结束\n\t\tif (this.isIdle()) {\n\t\t\tthis.stop();\n\t\t} else if (this.isPending() && this.children.length === 0 && this.running.length === 0) {\n\t\t\tthis.done();\n\t\t}\n\t}\n\t//\n\tpublic addChild(a: Action) {\n\t\tif ((this.isIdle() || this.isPending()) && !this.toStop) {\n\t\t\tsuper.addChild(a);\n\t\t\tif (this.isPending()) this.next();\n\t\t}\n\t\treturn this;\n\t}\n\tpublic numChildren() {\n\t\treturn this.children.length + this.running.length;\n\t}\n\t//\n\tprotected async doStart(context: any) {\n\t\t//如果自动停止\n\t\tif (this.stopHandler === RunQueue.StopHandlerAuto && this.children.length <= 0) return;\n\t\tif (this.children.length > 0) this.next();\n\t\tawait this.getRP().p;\n\t}\n\tprivate next() {\n\t\tif (!this.isPending()) return this.getRP().reject();\n\t\t//\n\t\twhile (this.children.length > 0 && (this.runCount <= 0 || this.running.length < this.runCount)) {\n\t\t\tconst action = this.children.shift();\n\t\t\tif (!action.isIdle()) continue;\n\t\t\tthis.running.push(action);\n\t\t\taction.start(this.context).then(\n\t\t\t\tthis.w ||\n\t\t\t\t\t(this.w = (action: Action) => {\n\t\t\t\t\t\tif (!this.isPending()) return this.getRP().reject();\n\t\t\t\t\t\t//\n\t\t\t\t\t\tlet index = this.running.indexOf(action);\n\t\t\t\t\t\tif (index >= 0) {\n\t\t\t\t\t\t\tthis.running.splice(index, 1);\n\t\t\t\t\t\t\tif (action.isRejected()) {\n\t\t\t\t\t\t\t\tif (!this.e) this.e = action.getError();\n\t\t\t\t\t\t\t\tif (this.errHandler === ErrHandler.RejectImmediately) return this.getRP().reject(this.e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//\n\t\t\t\t\t\tthis.next();\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\t//\n\t\tif (this.children.length === 0 && this.running.length === 0) {\n\t\t\tif (\n\t\t\t\tthis.stopHandler === RunQueue.StopHandlerAuto ||\n\t\t\t\tthis.stopHandler === RunQueue.StopHandlerAutoAtLeastOnce ||\n\t\t\t\tthis.toStop\n\t\t\t) {\n\t\t\t\tthis.toStop = true;\n\t\t\t\tthis.done();\n\t\t\t}\n\t\t}\n\t}\n\tprivate done() {\n\t\tif (this.e && this.errHandler !== ErrHandler.Ignore) {\n\t\t\tthis.getRP().reject(this.e);\n\t\t} else {\n\t\t\tthis.getRP().resolve();\n\t\t}\n\t}\n\tprotected async doStop(context: any) {\n\t\tthis.toStop = true;\n\t\tlet all = [];\n\t\tfor (const action of this.running) all.push(action.stop(context));\n\t\tthis.running.length = 0;\n\t\tfor (const action of this.children) all.push(action.stop(context));\n\t\tthis.children.length = 0;\n\t\tawait Promise.all(all);\n\t}\n\n\t//\n\tpublic addOne(a: Action) {\n\t\treturn this.addChild(a);\n\t}\n\tpublic async doOne(a: Action) {\n\t\tif ((this.isIdle() || this.isPending()) && !this.toStop) {\n\t\t\tsuper.addChild(a);\n\t\t\t//\n\t\t\tlet p = new Promise((resolve) => a.watch(resolve));\n\t\t\tif (this.isPending()) this.next();\n\t\t\tawait p;\n\t\t}\n\t\treturn a;\n\t}\n\tpublic async stopOne(a: string | Action) {\n\t\tfor (let i = 0; i < this.running.length; i++) {\n\t\t\tconst action = this.running[i];\n\t\t\tif (typeof a === 'string' && a !== action.getName()) continue;\n\t\t\tif (a !== action) continue;\n\t\t\t//\n\t\t\tthis.running.splice(i, 1);\n\t\t\tawait action.stop(this.context);\n\t\t\tthis.next();\n\t\t\treturn;\n\t\t}\n\t\tfor (let i = 0; i < this.children.length; i++) {\n\t\t\tconst action = this.running[i];\n\t\t\tif (typeof a === 'string' && a !== action.getName()) continue;\n\t\t\tif (a !== action) continue;\n\t\t\t//\n\t\t\tthis.children.splice(i, 1);\n\t\t\tawait action.stop(this.context);\n\t\t\treturn;\n\t\t}\n\t}\n\t//\n\tpublic addBatch(as: Action[]) {\n\t\tfor (let a of as) this.addChild(a);\n\t\treturn this;\n\t}\n\tpublic async doBatch(as: Action[], errHandler: number = ErrHandler.Ignore) {\n\t\tlet all = [];\n\t\tfor (let a of as) all.push(this.doOne(a));\n\t\tawait Promise.all(all);\n\t\t//\n\t\tif (errHandler !== ErrHandler.Ignore) {\n\t\t\tfor (let a of as) {\n\t\t\t\tif (a.isRejected()) return a.getError();\n\t\t\t}\n\t\t}\n\t}\n\tpublic async stopBatch(as: Action[]) {\n\t\tlet all = [];\n\t\tfor (let a of as) all.push(this.stopOne(a));\n\t\tawait Promise.all(all);\n\t}\n}\n","import { Action, CompositeAction } from './action';\nimport { ActionForFunc, type Func } from './action-func';\nimport { RunQueue } from './run-queue';\nimport { ErrHandler } from './utils';\n\nexport interface StepRange {\n\tfrom: number;\n\tto: number;\n\tcount: number;\n}\nexport type StepHandlerFactory = (\n\tcontext: any,\n\ti: number,\n\trange: StepRange,\n\tcaller: RunStep\n) => Action | Func | Promise<Action | Func>;\nexport type OnStep = (context: any, range: StepRange, caller: RunStep) => Promise<any>;\n\nexport class RunStep extends CompositeAction {\n\tprotected from: number;\n\tprotected step: number;\n\tprotected limit: number;\n\tprotected to: number;\n\tprotected onBeforeStep: OnStep;\n\tprotected handlerFactory: StepHandlerFactory;\n\tprotected onAfterStep: OnStep;\n\t//\n\tprotected queueAction!: RunQueue;\n\tprotected queueName: string;\n\tprotected toStop = false;\n\n\tconstructor(\n\t\tfrom = 0,\n\t\tstep = 0,\n\t\tlimit = 0,\n\t\tto = 0,\n\t\tonBeforeStep?: OnStep,\n\t\thandlerFactory?: StepHandlerFactory,\n\t\tonAfterStep?: OnStep,\n\t\terrHandler: number = ErrHandler.RejectAllDone\n\t) {\n\t\tsuper(errHandler);\n\t\tthis.from = from;\n\t\tthis.step = step;\n\t\tthis.limit = limit;\n\t\tthis.to = to;\n\t\tthis.onBeforeStep = onBeforeStep;\n\t\tthis.handlerFactory = handlerFactory;\n\t\tthis.onAfterStep = onAfterStep;\n\t}\n\tpublic setValues(from = 0, step = 0, limit = 0, to = 0) {\n\t\tthis.from = from;\n\t\tthis.step = step;\n\t\tthis.limit = limit;\n\t\tthis.to = to;\n\t\treturn this;\n\t}\n\tpublic setOnBeforeStep(fn: OnStep) {\n\t\tthis.onBeforeStep = fn;\n\t\treturn this;\n\t}\n\tpublic setHandlerFactory(fn: StepHandlerFactory) {\n\t\tthis.handlerFactory = fn;\n\t\treturn this;\n\t}\n\tpublic setOnAfterStep(fn: OnStep) {\n\t\tthis.onAfterStep = fn;\n\t\treturn this;\n\t}\n\tpublic setQueueName(name: string) {\n\t\tthis.queueName = name;\n\t\treturn this;\n\t}\n\tpublic setToStop() {\n\t\tthis.toStop = true;\n\t\treturn this;\n\t}\n\tpublic extendLimit(limit: number) {\n\t\tif (limit > this.limit) this.limit = limit;\n\t\treturn this.limit;\n\t}\n\tpublic extendTo(to: number) {\n\t\tif (to > this.to) this.to = to;\n\t\treturn this.to;\n\t}\n\t//\n\tpublic addChild(a: Action) {\n\t\tif (this.queueAction && !this.toStop) this.queueAction.addChild(a);\n\t\treturn this;\n\t}\n\tpublic numChildren() {\n\t\treturn this.queueAction ? this.queueAction.numChildren() : 0;\n\t}\n\t//\n\tprotected async doStart(context: any) {\n\t\tlet count = 0;\n\t\tlet e: Error;\n\t\tlet current = this.from;\n\t\twhile (current <= this.to) {\n\t\t\tthis.toStop = false;\n\t\t\t//1,3,5,10\n\t\t\tconst range: StepRange = { from: current, to: this.to, count };\n\t\t\t//截断\n\t\t\tif (this.step > 0) {\n\t\t\t\trange.to = Math.min(current + this.step - 1, this.to);\n\t\t\t}\n\t\t\t//截断\n\t\t\tif (this.limit > 0 && this.limit - count < range.to - range.from + 1) {\n\t\t\t\trange.to = range.from + (this.limit - count) - 1;\n\t\t\t}\n\n\t\t\t// before\n\t\t\tif (this.onBeforeStep) await this.onBeforeStep(context, range, this);\n\t\t\tif (!this.isPending()) break;\n\t\t\tif (this.toStop) {\n\t\t\t\tif (this.onAfterStep) await this.onAfterStep(context, range, this);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// pending\n\t\t\trange.count = count = count + (range.to - range.from + 1);\n\t\t\t//\n\t\t\tthis.queueAction = new RunQueue(0, RunQueue.StopHandlerAuto, this.errHandler);\n\t\t\t(this.queueAction as any).parent = this;\n\t\t\tif (this.queueName) this.queueAction.setName(this.queueName);\n\t\t\tfor (let i = range.from; i <= range.to; i++) {\n\t\t\t\tlet result = this.handlerFactory(context, i, range, this);\n\t\t\t\tlet af: Action | Func;\n\t\t\t\tlet a: Action;\n\t\t\t\t//\n\t\t\t\tif (result instanceof Promise) af = await result;\n\t\t\t\telse af = result;\n\t\t\t\tif (af instanceof Action) a = result as Action;\n\t\t\t\telse a = new ActionForFunc(af);\n\t\t\t\t//\n\t\t\t\tthis.queueAction.addChild(a);\n\t\t\t\t// console.log(i, options);\n\t\t\t\t// if (this.limit > 0 && count >= this.limit) { options.to = i; break; }\n\t\t\t}\n\t\t\tawait this.queueAction.start(context);\n\t\t\t//\n\t\t\tif (!this.isPending()) break;\n\t\t\tif (this.queueAction.isRejected()) {\n\t\t\t\tif (!e) e = this.queueAction.getError();\n\t\t\t\tif (this.errHandler === ErrHandler.RejectImmediately) throw e;\n\t\t\t}\n\t\t\tthis.queueAction = undefined;\n\n\t\t\t// after\n\t\t\tif (this.onAfterStep) await this.onAfterStep(context, range, this);\n\t\t\tif (!this.isPending()) break;\n\t\t\tif (this.toStop) break;\n\t\t\tif (this.limit > 0 && count >= this.limit) break;\n\t\t\t//\n\t\t\tcurrent = range.to + 1;\n\t\t\tif (current > this.to) break;\n\t\t}\n\t\t// console.log(\"done\");\n\t\tif (e && this.errHandler !== ErrHandler.Ignore) throw e;\n\t}\n\n\tprotected async doStop(context: any) {\n\t\tif (this.queueAction) await this.queueAction.stop(context);\n\t\tawait super.doStop(context);\n\t}\n}\n"],"names":[],"mappings":"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"}